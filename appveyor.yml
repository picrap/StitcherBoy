# StitcherBoy appveyor.yml script

branches:
  only:
    - master

version: '{branch}-{build}'
image: Visual Studio 2022

environment:
  NoTargetFrameworkNet35: true

install:
 - ps: |
    Invoke-WebRequest -Uri 'https://dot.net/v1/dotnet-install.ps1' -UseBasicParsing -OutFile "$env:temp\dotnet-install.ps1"
    & $env:temp\dotnet-install.ps1 -Architecture x64 -Version '10.0.100' -InstallDir "$env:ProgramFiles\dotnet"
  - git submodule update --init --recursive

before_build:
  - nuget restore

nuget:
  account_feed: true
  project_feed: true
  disable_publish_on_pr: true

configuration: Release

build:
  parallel: true
  publish_nuget: false
  publish_nuget_symbols: true
  verbosity: minimal
  project: StitcherBoy.sln

deploy:
  provider: NuGet
  api_key:
    secure: 1FFrOQ1to7x108dE3YPb8ACDEx7kJOJUXBw1M3RE5b8JeMa/G5qYffI1ZJg3td7o
  skip_symbols: true

artifacts:
  - path: '.\StitcherBoy\bin\Release\*.nupkg'

after_test:
  ps: Get-ChildItem .\StitcherBoy\bin\Release\*.nupkg | % { Push-AppveyorArtifact $_.FullName -FileName $_.Name }
